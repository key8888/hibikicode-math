# 第7章 三次関数
## 7.9 ちょっとだけ本格的に：自動で最適直線を出す

### 説明＆コード
簡易版の計算で、誤差をできるだけ小さくする直線を自動で求めてみよう。ここでは平均を使ったシンプルな近似を紹介する。

直線 \( y = ax + b \) の係数を、次の式で計算する（簡易版）：
\[
 a = \frac{\overline{x y} - \overline{x}\,\overline{y}}{\overline{x^2} - (\overline{x})^2}, \quad
 b = \overline{y} - a\,\overline{x}
\]
平均（バー）は全データの平均を表すよ。

```python
import numpy as np

data_x = np.array([0, 1, 2, 3, 4, 5, 6], dtype=float)
data_y = np.array([0.5, 1.0, 1.8, 2.7, 3.5, 4.2, 6.0], dtype=float)

mean_x = np.mean(data_x)
mean_y = np.mean(data_y)
mean_xy = np.mean(data_x * data_y)
mean_x2 = np.mean(data_x ** 2)

a = (mean_xy - mean_x * mean_y) / (mean_x2 - mean_x ** 2)
b = mean_y - a * mean_x

print(f"自動計算した傾き a = {a:.3f}")
print(f"自動計算した切片 b = {b:.3f}")
```

この \(a\) と \(b\) を使って直線を描けば、さっきの手作りよりもデータにフィットした線ができるはず。三次関数に進む前に、データ分析の入り口を体験しておこう。

#### ミニ課題
自分のデータに差し替えて \(a\) と \(b\) を計算してみよう。手作業で作った線と比べて、どちらが誤差合計が小さいか調べてみてね。

### 質問タイム
1. 平均を使うと、データ全体の「中心」をどう捉えられる？
2. \(a\) の分母がゼロになるときはどんなデータ？

### 振り返り
- [ ] 平均を使った簡易計算で直線の式を求める流れを理解できた？
- [ ] 手作りの線と自動計算の線の違いを説明できる？

### 発展
本格的な最小二乗法では、同じ式をもっと一般的に使う。高校数学IIの範囲で学ぶときに、今回の体験を思い出してみよう。
